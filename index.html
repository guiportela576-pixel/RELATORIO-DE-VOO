<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>üìù Relat√≥rio de Voo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css?v=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
</head>

<body>
  <main class="app-main">
    <header class="app-header">
      <div class="header-top">
        <h1>üìù Relat√≥rio de Voo</h1>
        <div class="subhead">Preencha o relat√≥rio do jeito da folha (DADOS DO VOO)</div>
      </div>

      <div class="tabs" role="tablist" aria-label="Navega√ß√£o">
        <button id="tabBtnNew" class="active" type="button" onclick="showTab('new')">
          <span class="tab-label">Novo</span>
        </button>
        <button id="tabBtnHistory" type="button" onclick="showTab('history')">
          <span class="tab-label">Hist√≥rico</span>
        </button>
        <button id="tabBtnUAs" type="button" onclick="showTab('uas')">
          <span class="tab-label">UA</span>
        </button>
      </div>
    </header>

    <!-- ======= TAB: NOVO ======= -->
    <section id="tab-new" class="tab-content">
      <section class="card">
        <h2>Dados do voo</h2>

        <div class="row" style="margin: 8px 0 10px 0;">
          <button id="btnStart" class="btn-green" type="button" onclick="startFlight()">Iniciar voo</button>
          <button id="btnEnd" class="btn-red" type="button" onclick="endFlight()">Encerrar voo</button>
        </div>

        <div id="runMsg" class="op-msg" style="display:none;"></div>

        <div class="grid">
          <input type="number" id="f_num" placeholder="N¬∫ (opcional)" min="1" />
          <input type="text" id="f_missao" placeholder="Miss√£o (opcional)" />

          <input type="text" id="f_voo" placeholder="Voo (opcional)" />
          <input type="time" id="f_inicio" placeholder="In√≠cio (HH:MM)" />

          <input type="number" id="f_tempo" placeholder="Tempo de voo (min)" min="1" />
          <select id="f_ua"></select>

          <input type="number" id="f_pousos" placeholder="Pousos (opcional)" min="0" />
          <input type="number" id="f_ciclos" placeholder="Ciclos (opcional)" min="0" />

          <input type="text" id="f_nbat" placeholder="N¬∫ Bat (opcional)" />
          <input type="number" id="f_carga_ini" placeholder="Carga inicial (%)" min="0" max="100" />

          <input type="number" id="f_carga_fim" class="span-2" placeholder="Carga final (%)" min="0" max="100" />
          <textarea id="f_obs" class="span-2" placeholder="Observa√ß√£o (opcional)"></textarea>
        </div>

        <div class="row" style="margin-top:10px;">
          <button class="primary" type="button" onclick="saveEntry()">Salvar</button>
          <button class="ghost" type="button" onclick="clearForm()">Limpar</button>
        </div>
      </section>
    </section>

    <!-- ======= TAB: HIST√ìRICO ======= -->
    <section id="tab-history" class="tab-content" style="display:none;">
      <section class="card">
        <div class="row space">
          <h2>Hist√≥rico</h2>
          <button class="ghost" type="button" onclick="exportTextAll()">Copiar tudo</button>
        </div>

        <div class="grid" style="margin-top:10px;">
          <input type="date" id="filterDate" />
          <select id="filterUA"></select>
        </div>

        <div class="row" style="margin-top:8px;">
          <button type="button" onclick="applyFilters()">Aplicar</button>
          <button type="button" class="ghost" onclick="clearFilters()">Limpar</button>
        </div>

        <ul id="historyList" class="list" style="margin-top:10px;"></ul>
        <div id="emptyHistory" class="hint" style="display:none; margin-top:10px;">Nenhum registro ainda.</div>
      </section>
    </section>

    <!-- ======= TAB: UA ======= -->
    <section id="tab-uas" class="tab-content" style="display:none;">
      <section class="card">
        <h2>UA (Drone)</h2>
        <p class="hint">Cadastre aqui suas UAs para n√£o precisar digitar toda vez.</p>

        <div class="grid">
          <input type="text" id="uaNew" class="span-2" placeholder="Digite uma UA (ex: MAVIC 2 ZOOM)" />
        </div>
        <div class="row" style="margin-top:8px;">
          <button type="button" onclick="addUA()">Adicionar</button>
          <button type="button" class="ghost" onclick="setDefaultUA()">Definir como padr√£o</button>
        </div>

        <h3 style="margin-top:12px;">Lista</h3>
        <ul id="uaList" class="list"></ul>

        <div class="divider"></div>

        <h3>Vers√£o</h3>
        <div class="version-box">
          <div><strong>Vers√£o do app:</strong> <span id="appVersion">‚Äî</span></div>
          <div style="margin-top:6px;"><strong>Hist√≥rico:</strong></div>
          <ul id="versionHistory" class="list compact"></ul>
        </div>
      </section>
    </section>

    <!-- ======= MODAL: EDITAR ======= -->
    <div id="modalOverlay" class="modal-overlay" style="display:none;">
      <div class="modal-card">
        <div class="modal-header">
          <h2>Editar registro</h2>
          <button type="button" class="icon-btn" onclick="closeModal()">‚úñ</button>
        </div>

        <div class="modal-sub" id="modalSub">‚Äî</div>

        <div class="grid" style="margin-top:10px;">
          <input type="number" id="e_num" placeholder="N¬∫ (opcional)" min="1" />
          <input type="text" id="e_missao" placeholder="Miss√£o (opcional)" />

          <input type="text" id="e_voo" placeholder="Voo (opcional)" />
          <input type="time" id="e_inicio" placeholder="In√≠cio (HH:MM)" />

          <input type="number" id="e_tempo" placeholder="Tempo de voo (min)" min="1" />
          <select id="e_ua"></select>

          <input type="number" id="e_pousos" placeholder="Pousos (opcional)" min="0" />
          <input type="number" id="e_ciclos" placeholder="Ciclos (opcional)" min="0" />

          <input type="text" id="e_nbat" placeholder="N¬∫ Bat (opcional)" />
          <input type="number" id="e_carga_ini" placeholder="Carga inicial (%)" min="0" max="100" />

          <input type="number" id="e_carga_fim" class="span-2" placeholder="Carga final (%)" min="0" max="100" />
          <textarea id="e_obs" class="span-2" placeholder="Observa√ß√£o (opcional)"></textarea>
        </div>

        <div class="row" style="margin-top:10px;">
          <button class="primary" type="button" onclick="saveEdit()">Salvar</button>
          <button class="ghost" type="button" onclick="deleteEdit()">Excluir</button>
        </div>
      </div>
    </div>

    <footer class="tabs-footer" aria-hidden="true"></footer>
  </main>

  <script src="app.js?v=1"></script>
</body>
</html>
